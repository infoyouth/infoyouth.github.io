---
title: "30. Web Development with Flask"
description: "üåê Master Flask web development! Learn routing, templates, forms, databases, and REST APIs. Build production-ready web applications! ‚ú®"
author: infoyouth
date: 2026-01-05 02:00:00 +0000
categories:
  - Programming
  - Python
  - Web Development
  - Flask
tags:
  - Python
  - Flask
  - Web Development
  - Jinja2
  - REST API
  - SQLAlchemy
  - Flask-WTF
pin: true
math: false
mermaid: true
---

<!--
meta-description: "Comprehensive guide to Flask web development covering routing, URL building, Jinja2 templates, form handling with Flask-WTF, database integration with SQLAlchemy, and building RESTful APIs with practical examples."
keywords: "Flask Python, web development, Flask routing, Jinja2 templates, Flask-WTF forms, Flask-SQLAlchemy, REST API, Flask tutorial, Python web framework, Flask microservices"
-->

# <span style="color:#e67e22;">What we will learn in this post?</span>
<ul style='list-style-type: none; padding-left: 0;'>
<li><span style='color: #2980b9; font-size: 20px; font-weight: bold;'>üëâ</span> <span style='color: #2ecc71; font-size: 18px; font-weight: bold;'>Introduction to Flask</span></li>
<li><span style='color: #2980b9; font-size: 20px; font-weight: bold;'>üëâ</span> <span style='color: #2ecc71; font-size: 18px; font-weight: bold;'>Setting Up Flask and First Application</span></li>
<li><span style='color: #2980b9; font-size: 20px; font-weight: bold;'>üëâ</span> <span style='color: #2ecc71; font-size: 18px; font-weight: bold;'>Routing and URL Building</span></li>
<li><span style='color: #2980b9; font-size: 20px; font-weight: bold;'>üëâ</span> <span style='color: #2ecc71; font-size: 18px; font-weight: bold;'>Templates with Jinja2</span></li>
<li><span style='color: #2980b9; font-size: 20px; font-weight: bold;'>üëâ</span> <span style='color: #2ecc71; font-size: 18px; font-weight: bold;'>Handling Forms and User Input</span></li>
<li><span style='color: #2980b9; font-size: 20px; font-weight: bold;'>üëâ</span> <span style='color: #2ecc71; font-size: 18px; font-weight: bold;'>Flask and Databases</span></li>
<li><span style='color: #2980b9; font-size: 20px; font-weight: bold;'>üëâ</span> <span style='color: #2ecc71; font-size: 18px; font-weight: bold;'>Flask REST APIs</span></li>
</ul>

# <span style="color:#e67e22">Introduction to Flask</span> üåê

Flask is a **lightweight web framework** for Python that makes building web applications easy and fun! It follows the **micro-framework** philosophy, meaning it provides the essentials without unnecessary features. This allows developers to add only what they need, keeping applications simple and efficient.

## <span style="color:#2980b9">Flask vs. Django</span> ‚öñÔ∏è

- **Flask**:
  - Lightweight and flexible
  - Great for small to medium projects
  - Easy to learn and use
  - Ideal for microservices

- **Django**:
  - Full-featured framework
  - Best for large applications
  - Comes with built-in features like admin panels and ORM

### <span style="color:#8e44ad">When to Choose Flask</span> ü§î

- You want **quick development** for small projects.
- You prefer **flexibility** and control over components.
- You need a **simple API** or microservice.

Flask is also highly **extensible**! You can easily add libraries and tools to enhance your application. Companies like Netflix, Reddit, and Lyft use Flask to power critical microservices handling millions of requests per day.

```mermaid
graph TD
    A["üéØ Start with Flask"]:::style1 --> B{"üí° Choose Components"}:::style2
    B -- "Minimal" --> C["‚ö° Core Flask Only"]:::style3
    B -- "Extended" --> D["üîß Add Extensions"]:::style4
    C --> E["üöÄ Build Your App"]:::style5
    D --> E
    
    classDef style1 fill:#ff4f81,stroke:#c43e3e,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style2 fill:#ffd700,stroke:#d99120,color:#222,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style3 fill:#43e97b,stroke:#38f9d7,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style4 fill:#6b5bff,stroke:#4a3f6b,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style5 fill:#ff9800,stroke:#f57c00,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    
    linkStyle default stroke:#e67e22,stroke-width:3px;
```

With Flask, you can create powerful web applications while keeping things simple and enjoyable! Happy coding! üéâ

# <span style="color:#e67e22">Getting Started with Flask! üöÄ</span>

## <span style="color:#2980b9">Installing Flask</span>

To start, you need to install Flask. Open your terminal and run:

```bash
pip install Flask
```

## <span style="color:#2980b9">Creating a Minimal Flask Application</span>

Now, let‚Äôs create a simple "Hello World" app! Create a file named `app.py` and add the following code:

```python
from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello():
    return 'Hello, World!'

if __name__ == '__main__':
    app.run(debug=True)
```

### <span style="color:#8e44ad">Understanding the Code</span>

- **`Flask(__name__)`**: This creates the app object.
- **`@app.route('/')`**: This defines a route for the homepage.
- **`hello()`**: This function returns "Hello, World!" when you visit the homepage.
- **`app.run(debug=True)`**: This runs the server in debug mode.

## <span style="color:#2980b9">Running the Development Server</span>

To run your app, execute:

```bash
python app.py
```

Now, open your browser and go to `http://127.0.0.1:5000/` to see your "Hello, World!" message! üéâ In production, you'd use a WSGI server like Gunicorn or uWSGI instead of the development server.

```mermaid
%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#ff4f81','primaryTextColor':'#fff','primaryBorderColor':'#c43e3e','lineColor':'#e67e22','secondaryColor':'#6b5bff','tertiaryColor':'#ffd700'}}}%%
sequenceDiagram
    participant B as üåê Browser
    participant F as ‚öôÔ∏è Flask App
    participant R as üéØ Route Handler
    
    Note over B,F: HTTP Request Lifecycle
    B->>+F: GET / HTTP/1.1
    F->>F: Match route decorator
    F->>+R: Call hello()
    R-->>-F: Return 'Hello, World!'
    F-->>-B: HTTP 200 with HTML
    Note left of B: Page rendered ‚úÖ
```

# <span style="color:#e67e22">Flask Routing Made Easy! üöÄ</span>

Flask is a fantastic web framework for Python, and one of its coolest features is **routing**! Let's break it down.

## <span style="color:#2980b9">What is Routing? üåê</span>

Routing in Flask helps you connect URLs to functions. You use the `@app.route()` decorator to define a route. Here‚Äôs a simple example:

```python
@app.route('/')
def home():
    return "Welcome to my website!"
```

### <span style="color:#8e44ad">Using URL Parameters üì¶</span>

You can also capture parts of the URL as parameters. For example:

```python
@app.route('/user/<username>')
def show_user(username):
    return f"Hello, {username}!"
```

### <span style="color:#8e44ad">Variable Rules üîÑ</span>

You can define variable rules in your routes:

```python
@app.route('/post/<int:post_id>')
def show_post(post_id):
    return f"Post ID: {post_id}"
```

### <span style="color:#8e44ad">HTTP Methods (GET, POST) üì¨</span>

Flask supports different HTTP methods. By default, routes respond to **GET** requests. To handle **POST** requests, you can specify it like this:

```python
@app.route('/submit', methods=['POST'])
def submit():
    return "Form submitted!"
```

### <span style="color:#8e44ad">Using url_for() üîó</span>

The `url_for()` function helps you build URLs dynamically. For example:

```python
url_for('show_user', username='Alice')
```

This generates the URL `/user/Alice`.

```mermaid
graph TD
    A["üë§ User Request"]:::style1 --> B{"üéØ HTTP Method"}:::style2
    B -- "GET /" --> C["üè† Home Page"]:::style3
    B -- "GET /user/<name>" --> D["üë• User Profile"]:::style4
    B -- "POST /submit" --> E["üìù Submit Form"]:::style5
    B -- "GET /api/data" --> F["üìä JSON Response"]:::style6
    
    classDef style1 fill:#ff4f81,stroke:#c43e3e,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style2 fill:#ffd700,stroke:#d99120,color:#222,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style3 fill:#43e97b,stroke:#38f9d7,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style4 fill:#6b5bff,stroke:#4a3f6b,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style5 fill:#ff9800,stroke:#f57c00,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style6 fill:#00bfae,stroke:#005f99,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    
    linkStyle default stroke:#e67e22,stroke-width:3px;
```

### <span style="color:#8e44ad">Real-World Example: RESTful User API üéØ</span>

```python
from flask import Flask, jsonify, request, abort
from functools import wraps
import jwt
import datetime

app = Flask(__name__)
app.config['SECRET_KEY'] = 'your-secret-key-here'

# In-memory user database (use real DB in production)
users = {
    1: {'id': 1, 'name': 'Alice', 'email': 'alice@example.com'},
    2: {'id': 2, 'name': 'Bob', 'email': 'bob@example.com'}
}

def token_required(f):
    """Decorator to protect routes with JWT authentication"""
    @wraps(f)
    def decorated(*args, **kwargs):
        token = request.headers.get('Authorization')
        if not token:
            return jsonify({'message': 'Token is missing'}), 401
        
        try:
            token = token.split()[1]  # Remove 'Bearer' prefix
            data = jwt.decode(token, app.config['SECRET_KEY'], algorithms=['HS256'])
            current_user_id = data['user_id']
        except:
            return jsonify({'message': 'Token is invalid'}), 401
        
        return f(current_user_id, *args, **kwargs)
    return decorated

@app.route('/api/login', methods=['POST'])
def login():
    """Generate JWT token for authentication"""
    auth = request.get_json()
    
    # Validate credentials (simplified for demo)
    if auth and auth.get('email') == 'alice@example.com':
        token = jwt.encode({
            'user_id': 1,
            'exp': datetime.datetime.utcnow() + datetime.timedelta(hours=24)
        }, app.config['SECRET_KEY'], algorithm='HS256')
        
        return jsonify({'token': token})
    
    return jsonify({'message': 'Invalid credentials'}), 401

@app.route('/api/users', methods=['GET'])
@token_required
def get_users(current_user_id):
    """Get all users (protected route)"""
    return jsonify({'users': list(users.values())})

@app.route('/api/users/<int:user_id>', methods=['GET'])
@token_required
def get_user(current_user_id, user_id):
    """Get specific user by ID"""
    user = users.get(user_id)
    if not user:
        abort(404, description='User not found')
    return jsonify(user)

@app.route('/api/users', methods=['POST'])
@token_required
def create_user(current_user_id):
    """Create new user"""
    data = request.get_json()
    
    if not data or 'name' not in data or 'email' not in data:
        abort(400, description='Missing required fields')
    
    new_id = max(users.keys()) + 1
    users[new_id] = {
        'id': new_id,
        'name': data['name'],
        'email': data['email']
    }
    
    return jsonify(users[new_id]), 201

@app.route('/api/users/<int:user_id>', methods=['PUT'])
@token_required
def update_user(current_user_id, user_id):
    """Update existing user"""
    if user_id not in users:
        abort(404, description='User not found')
    
    data = request.get_json()
    users[user_id].update(data)
    return jsonify(users[user_id])

@app.route('/api/users/<int:user_id>', methods=['DELETE'])
@token_required
def delete_user(current_user_id, user_id):
    """Delete user"""
    if user_id not in users:
        abort(404, description='User not found')
    
    del users[user_id]
    return '', 204

if __name__ == '__main__':
    app.run(debug=True)
```

**Why This Matters**: This RESTful API pattern with JWT authentication is used by companies like Stripe, Twilio, and GitHub for their APIs. It provides secure, stateless authentication perfect for microservices architectures.

{% include quiz.html 
  question="What HTTP method should you use to update an existing resource in a RESTful API?"
  options="GET|POST|PUT|DELETE"
  correct="2"
  explanation="PUT is the standard HTTP method for updating existing resources. POST creates new resources, GET retrieves them, and DELETE removes them." 
%}

Happy coding! üòä

# <span style="color:#e67e22">Introduction to Jinja2 Templating Engine</span> üéâ

Jinja2 is a powerful templating engine for Python, widely used in web frameworks like Flask. It allows you to create dynamic web pages by separating HTML from Python code. Let‚Äôs explore its key features!

## <span style="color:#2980b9">Template Syntax</span> üìù

Jinja2 uses a simple syntax to embed Python-like expressions in HTML. Here are some basics:

- **Variables**: Use `{{ variable_name }}` to display variables.
- **Filters**: Modify variables with filters like `{{ name|capitalize }}`.

### <span style="color:#8e44ad">Control Structures</span> üîÑ

You can control the flow of your templates using:

- **If Statements**:
  ```jinja
  {% if user %}
    Hello, {{ user }}!
  {% else %}
    Hello, Guest!
  {% endif %}
  ```

- **For Loops**:
  ```jinja
  <ul>
  {% for item in items %}
    <li>{{ item }}</li>
  {% endfor %}
  </ul>
  ```

## <span style="color:#2980b9">Template Inheritance</span> üèóÔ∏è

Jinja2 supports template inheritance, allowing you to create a base template and extend it:

```jinja
{% extends "base.html" %}
{% block content %}
  <h1>Welcome!</h1>
{% endblock %}
```

## <span style="color:#2980b9">Rendering Templates</span> üöÄ

To render templates in Flask, use `render_template()`:

```python
from flask import render_template

@app.route('/')
def home():
    return render_template('index.html', user='Alice')
```

# <span style="color:#e67e22">Handling Form Data in Flask</span> üòä

Flask makes it easy to handle form data! Let‚Äôs explore how to use `request.form`, `request.args`, and `request.json` for different types of data. 

## <span style="color:#2980b9">Getting Data from Forms</span> üìù

When you submit a form, you can access the data in different ways:

- **`request.form`**: Use this for form data sent via POST. It‚Äôs great for handling user inputs like text fields.
  
  ```python
  from flask import Flask, request
  
  @app.route('/submit', methods=['POST'])
  def submit():
      name = request.form['name']
      return f"Hello, {name}!"
  ```

- **`request.args`**: This is for data sent via GET requests, like query parameters in the URL.

- **`request.json`**: Use this for JSON data sent in the body of a POST request.

## <span style="color:#2980b9">Form Validation with Flask-WTF</span> ‚úÖ

To ensure your forms are filled out correctly, you can use **Flask-WTF**. It simplifies form handling and validation.

### <span style="color:#8e44ad">Basic Steps to Use Flask-WTF</span>:

1. Install Flask-WTF: 
   ```bash
   pip install Flask-WTF
   ```

2. Create a form class with validation rules.

3. Use the form in your route to handle submissions.

```mermaid
graph TD
    A["üìù User Submits Form"]:::style1 --> B["üîç Flask-WTF Validates"]:::style2
    B --> C{"‚úÖ Is Valid?"}:::style3
    C -- "Yes" --> D["üíæ Process Data"]:::style4
    C -- "No" --> E["‚ùå Show Errors"]:::style5
    D --> F["‚ú® Success Response"]:::style6
    E --> G["üîÑ Re-render Form"]:::style7
    
    classDef style1 fill:#ff4f81,stroke:#c43e3e,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style2 fill:#6b5bff,stroke:#4a3f6b,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style3 fill:#ffd700,stroke:#d99120,color:#222,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style4 fill:#00bfae,stroke:#005f99,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style5 fill:#c43e3e,stroke:#8b2e2e,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style6 fill:#43e97b,stroke:#38f9d7,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style7 fill:#ff9800,stroke:#f57c00,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    
    linkStyle default stroke:#e67e22,stroke-width:3px;
```

```mermaid
graph TD
    A["üìÑ base.html"]:::style1 --> B["üé® Header Block"]:::style2
    A --> C["üì¶ Content Block"]:::style3
    A --> D["üîª Footer Block"]:::style4
    
    E["üìÑ index.html"]:::style5 --> F["üîó extends base.html"]:::style6
    F --> G["‚úèÔ∏è Override content"]:::style7
    G --> C
    
    classDef style1 fill:#ff4f81,stroke:#c43e3e,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style2 fill:#ffd700,stroke:#d99120,color:#222,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style3 fill:#6b5bff,stroke:#4a3f6b,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style4 fill:#00bfae,stroke:#005f99,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style5 fill:#ff9800,stroke:#f57c00,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style6 fill:#43e97b,stroke:#38f9d7,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style7 fill:#6b5bff,stroke:#4a3f6b,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    
    linkStyle default stroke:#e67e22,stroke-width:3px;
```


{% include quiz.html 
  question="Which Flask object contains form data submitted via POST request?"
  options="request.args|request.form|request.json|request.data"
  correct="1"
  explanation="request.form contains form data from POST requests (application/x-www-form-urlencoded). request.args is for URL query parameters, and request.json is for JSON payloads." 
%}

# <span style="color:#e67e22">Integrating Databases with Flask using Flask-SQLAlchemy</span> üöÄ

Flask-SQLAlchemy makes it easy to work with databases in your Flask app. Let‚Äôs dive into how to set it up and perform some basic CRUD operations!

## <span style="color:#2980b9">Setting Up Flask-SQLAlchemy</span> üõ†Ô∏è

First, install Flask and Flask-SQLAlchemy:

```bash
pip install Flask Flask-SQLAlchemy
```

### <span style="color:#8e44ad">Defining Models</span> üìö

Create a simple model for a `User`:

```python
from flask import Flask
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///users.db'
db = SQLAlchemy(app)

class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(80), nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)
```

### <span style="color:#8e44ad">Creating Tables</span> üèóÔ∏è

Run this in your Python shell to create the database:

```python
db.create_all()
```

## <span style="color:#2980b9">Performing CRUD Operations</span> üîÑ

### Create a User

```python
@app.route('/add_user/<name>/<email>')
def add_user(name, email):
    new_user = User(name=name, email=email)
    db.session.add(new_user)
    db.session.commit()
    return f'User {name} added!'
```

### Read Users

```python
@app.route('/users')
def get_users():
    users = User.query.all()
    return {user.id: user.name for user in users}
```

### Update a User

```python
@app.route('/update_user/<int:id>/<name>')
def update_user(id, name):
    user = User.query.get(id)
    user.name = name
    db.session.commit()
    return f'User {id} updated!'
```

### Delete a User

```python
@app.route('/delete_user/<int:id>')
def delete_user(id):
    user = User.query.get(id)
    db.session.delete(user)
    db.session.commit()
    return f'User {id} deleted!'
```

```mermaid
graph TD
    A["‚öôÔ∏è Flask Application"]:::style1 --> B["üîó Flask-SQLAlchemy"]:::style2
    B --> C["üóÉÔ∏è SQLite/PostgreSQL/MySQL"]:::style3
    
    D["üìä Model Classes"]:::style4 --> B
    D --> E["üë§ User Model"]:::style5
    D --> F["üìù Post Model"]:::style6
    D --> G["üí¨ Comment Model"]:::style7
    
    E -."1:N".-> F
    F -."1:N".-> G
    
    classDef style1 fill:#ff4f81,stroke:#c43e3e,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style2 fill:#6b5bff,stroke:#4a3f6b,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style3 fill:#00bfae,stroke:#005f99,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style4 fill:#ffd700,stroke:#d99120,color:#222,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style5 fill:#43e97b,stroke:#38f9d7,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style6 fill:#ff9800,stroke:#f57c00,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style7 fill:#9e9e9e,stroke:#616161,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    
    linkStyle default stroke:#e67e22,stroke-width:3px;
```

{% include quiz.html 
  question="Which method is used to add a new record to the database in Flask-SQLAlchemy?"
  options="db.insert()|db.session.add()|db.create()|db.save()"
  correct="1"
  explanation="db.session.add() adds a new object to the session, and db.session.commit() persists it to the database. Flask-SQLAlchemy uses SQLAlchemy's session pattern for database operations." 
%}

Feel free to ask if you have any questions! üòä

### <span style="color:#8e44ad">Real-World Example: Blog System with Relationships üéØ</span>

```python
from flask import Flask, request, jsonify
from flask_sqlalchemy import SQLAlchemy
from datetime import datetime
from werkzeug.security import generate_password_hash, check_password_hash

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///blog.db'
app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False
db = SQLAlchemy(app)

# Models with relationships
class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)
    password_hash = db.Column(db.String(200), nullable=False)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    
    # Relationships
    posts = db.relationship('Post', backref='author', lazy='dynamic', 
                          cascade='all, delete-orphan')
    comments = db.relationship('Comment', backref='author', lazy='dynamic',
                              cascade='all, delete-orphan')
    
    def set_password(self, password):
        self.password_hash = generate_password_hash(password)
    
    def check_password(self, password):
        return check_password_hash(self.password_hash, password)
    
    def to_dict(self):
        return {
            'id': self.id,
            'username': self.username,
            'email': self.email,
            'created_at': self.created_at.isoformat(),
            'post_count': self.posts.count()
        }

class Post(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    title = db.Column(db.String(200), nullable=False)
    content = db.Column(db.Text, nullable=False)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    updated_at = db.Column(db.DateTime, default=datetime.utcnow, 
                          onupdate=datetime.utcnow)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)
    
    # Relationships
    comments = db.relationship('Comment', backref='post', lazy='dynamic',
                              cascade='all, delete-orphan')
    
    def to_dict(self, include_comments=False):
        data = {
            'id': self.id,
            'title': self.title,
            'content': self.content,
            'created_at': self.created_at.isoformat(),
            'updated_at': self.updated_at.isoformat(),
            'author': self.author.username,
            'comment_count': self.comments.count()
        }
        
        if include_comments:
            data['comments'] = [c.to_dict() for c in self.comments]
        
        return data

class Comment(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    content = db.Column(db.Text, nullable=False)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)
    post_id = db.Column(db.Integer, db.ForeignKey('post.id'), nullable=False)
    
    def to_dict(self):
        return {
            'id': self.id,
            'content': self.content,
            'created_at': self.created_at.isoformat(),
            'author': self.author.username
        }

# API endpoints
@app.route('/api/posts', methods=['GET'])
def get_posts():
    """Get all posts with pagination"""
    page = request.args.get('page', 1, type=int)
    per_page = request.args.get('per_page', 10, type=int)
    
    posts = Post.query.order_by(Post.created_at.desc()).paginate(
        page=page, per_page=per_page, error_out=False
    )
    
    return jsonify({
        'posts': [post.to_dict() for post in posts.items],
        'total': posts.total,
        'page': page,
        'pages': posts.pages
    })

@app.route('/api/posts/<int:post_id>', methods=['GET'])
def get_post(post_id):
    """Get single post with comments"""
    post = Post.query.get_or_404(post_id)
    return jsonify(post.to_dict(include_comments=True))

@app.route('/api/posts', methods=['POST'])
def create_post():
    """Create new post"""
    data = request.get_json()
    
    # Validate required fields
    if not data or 'title' not in data or 'content' not in data:
        return jsonify({'error': 'Missing required fields'}), 400
    
    # Get or create user (simplified - use proper auth in production)
    user = User.query.filter_by(username=data.get('author', 'anonymous')).first()
    if not user:
        user = User(username=data.get('author', 'anonymous'),
                   email=f"{data.get('author', 'anonymous')}@example.com")
        user.set_password('password123')
        db.session.add(user)
    
    # Create post
    post = Post(
        title=data['title'],
        content=data['content'],
        author=user
    )
    
    db.session.add(post)
    db.session.commit()
    
    return jsonify(post.to_dict()), 201

@app.route('/api/posts/<int:post_id>/comments', methods=['POST'])
def add_comment(post_id):
    """Add comment to post"""
    post = Post.query.get_or_404(post_id)
    data = request.get_json()
    
    if not data or 'content' not in data:
        return jsonify({'error': 'Missing content'}), 400
    
    # Get or create user
    user = User.query.filter_by(username=data.get('author', 'anonymous')).first()
    if not user:
        user = User(username=data.get('author', 'anonymous'),
                   email=f"{data.get('author', 'anonymous')}@example.com")
        user.set_password('password123')
        db.session.add(user)
    
    comment = Comment(
        content=data['content'],
        post=post,
        author=user
    )
    
    db.session.add(comment)
    db.session.commit()
    
    return jsonify(comment.to_dict()), 201

@app.route('/api/users/<username>/posts', methods=['GET'])
def get_user_posts(username):
    """Get all posts by a user"""
    user = User.query.filter_by(username=username).first_or_404()
    posts = user.posts.order_by(Post.created_at.desc()).all()
    
    return jsonify({
        'user': user.to_dict(),
        'posts': [post.to_dict() for post in posts]
    })

if __name__ == '__main__':
    with app.app_context():
        db.create_all()  # Create tables
    app.run(debug=True)
```

**Why This Matters**: This blog system demonstrates SQLAlchemy relationships (one-to-many), cascade deletes, and pagination - essential patterns used by WordPress, Medium, and DEV.to. The relationship handling prevents orphaned records and maintains data integrity across millions of posts.

# <span style="color:#e67e22">Creating RESTful APIs with Flask</span> üåê

Flask is a lightweight web framework for Python that makes it easy to create RESTful APIs. Let‚Äôs break down how to do this in a friendly way!

## <span style="color:#2980b9">Getting Started with Flask</span> üöÄ

1. **Install Flask**: Use pip to install Flask:
   ```bash
   pip install Flask
   ```

2. **Create a Simple API**:
   Here‚Äôs a basic example of a Flask app that returns JSON responses:
   ```python
   from flask import Flask, jsonify

   app = Flask(__name__)

   @app.route('/api/greet', methods=['GET'])
   def greet():
       return jsonify(message="Hello, World!")

   if __name__ == '__main__':
       app.run(debug=True)
   ```

### <span style="color:#8e44ad">Handling Different HTTP Methods</span> üîÑ

You can handle various HTTP methods like GET, POST, PUT, and DELETE. Here‚Äôs how:

- **GET**: Retrieve data.
- **POST**: Create new data.
- **PUT**: Update existing data.
- **DELETE**: Remove data.

Example for a POST request:
```python
@app.route('/api/items', methods=['POST'])
def create_item():
    item = request.json
    return jsonify(item), 201
```

## <span style="color:#2980b9">Using Flask-RESTful</span> üõ†Ô∏è

Flask-RESTful is an extension that simplifies API creation. It provides tools to build REST APIs quickly.

### Example with Flask-RESTful:
```python
from flask_restful import Resource, Api

api = Api(app)

class Item(Resource):
    def get(self):
        return {'item': 'example'}

api.add_resource(Item, '/api/item')
```

### Flowchart of API Request Handling
```mermaid
graph TD
    A["üåê Client Request"]:::style1 --> B{"üéØ HTTP Method"}:::style2
    B -- "GET" --> C["üìñ Retrieve Data"]:::style3
    B -- "POST" --> D["‚ú® Create Data"]:::style4
    B -- "PUT" --> E["‚úèÔ∏è Update Data"]:::style5
    B -- "DELETE" --> F["üóëÔ∏è Delete Data"]:::style6
    
    C --> G["üì¶ JSON Response 200"]:::style7
    D --> H["üì¶ JSON Response 201"]:::style8
    E --> G
    F --> I["üì¶ Empty Response 204"]:::style9
    
    classDef style1 fill:#ff4f81,stroke:#c43e3e,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style2 fill:#ffd700,stroke:#d99120,color:#222,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style3 fill:#43e97b,stroke:#38f9d7,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style4 fill:#6b5bff,stroke:#4a3f6b,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style5 fill:#ff9800,stroke:#f57c00,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style6 fill:#c43e3e,stroke:#8b2e2e,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style7 fill:#00bfae,stroke:#005f99,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style8 fill:#6b5bff,stroke:#4a3f6b,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    classDef style9 fill:#9e9e9e,stroke:#616161,color:#fff,font-size:16px,stroke-width:3px,rx:14,shadow:6px;
    
    linkStyle default stroke:#e67e22,stroke-width:3px;
```
<details style='border: 2px solid #ff9800; border-radius: 8px; padding: 20px; background: linear-gradient(135deg, #fff3e0 0%, #fff 100%); margin: 25px 0; box-shadow: 0 6px 12px rgba(255, 152, 0, 0.15);'>
<summary style='cursor: pointer; font-size: 1.3em; font-weight: bold; color: #ff9800; padding: 10px 0;'>
üéØ Hands-On Assignment: Build a Task Management API with Authentication üöÄ
</summary>

<div style='margin-top: 20px; color: #2c3e50; line-height: 1.6;'>

<h3 style='color: #ff9800; border-bottom: 2px solid #ff9800; padding-bottom: 8px; margin-top: 20px;'>üìù Your Mission</h3>

Create a production-ready RESTful API for task management using Flask. Build a complete system with user authentication (JWT tokens), CRUD operations for tasks, SQLAlchemy database models with relationships, and proper error handling. This project combines routing, forms, databases, and REST API concepts covered in this post.

<h3 style='color: #ff9800; border-bottom: 2px solid #ff9800; padding-bottom: 8px; margin-top: 20px;'>üéØ Requirements</h3>

<ol style='margin-left: 20px;'>
<li>Implement User authentication system:
  <ul style='margin-left: 20px; margin-top: 8px;'>
    <li><code>POST /api/register</code> - Register new user with password hashing</li>
    <li><code>POST /api/login</code> - Login and receive JWT token</li>
    <li>Use <code>@token_required</code> decorator to protect routes</li>
  </ul>
</li>
<li>Create Task CRUD operations:
  <ul style='margin-left: 20px; margin-top: 8px;'>
    <li><code>GET /api/tasks</code> - List all tasks for authenticated user</li>
    <li><code>GET /api/tasks/<id></code> - Get single task details</li>
    <li><code>POST /api/tasks</code> - Create new task</li>
    <li><code>PUT /api/tasks/<id></code> - Update task</li>
    <li><code>DELETE /api/tasks/<id></code> - Delete task</li>
  </ul>
</li>
<li>Database models with Flask-SQLAlchemy:
  <ul style='margin-left: 20px; margin-top: 8px;'>
    <li><code>User</code> model: id, username, email, password_hash, created_at</li>
    <li><code>Task</code> model: id, title, description, status, priority, due_date, user_id</li>
    <li>Relationship: User has many Tasks (one-to-many)</li>
  </ul>
</li>
<li>Add task filtering and pagination:
  <ul style='margin-left: 20px; margin-top: 8px;'>
    <li>Filter by status: <code>?status=completed</code></li>
    <li>Filter by priority: <code>?priority=high</code></li>
    <li>Pagination: <code>?page=1&per_page=10</code></li>
  </ul>
</li>
<li>Implement proper error handling with appropriate HTTP status codes</li>
<li>Write at least 3 test cases using pytest or unittest</li>
</ol>

<h3 style='color: #ff9800; border-bottom: 2px solid #ff9800; padding-bottom: 8px; margin-top: 25px;'>üí° Implementation Hints</h3>

<ol style='margin-left: 20px;'>
<li>Install required packages: <code>pip install Flask Flask-SQLAlchemy PyJWT werkzeug</code></li>
<li>Use <code>werkzeug.security.generate_password_hash()</code> for password hashing</li>
<li>Generate JWT with: <code>jwt.encode({'user_id': user.id, 'exp': ...}, SECRET_KEY)</code></li>
<li>Protect routes with decorator that checks JWT from <code>Authorization</code> header</li>
<li>Use <code>db.relationship()</code> with <code>backref</code> for User-Task relationship</li>
<li>For filtering: <code>Task.query.filter_by(status=status, user_id=user_id)</code></li>
<li>For pagination: <code>.paginate(page=page, per_page=per_page)</code></li>
</ol>

<h3 style='color: #ff9800; border-bottom: 2px solid #ff9800; padding-bottom: 8px; margin-top: 25px;'>üöÄ Example Input/Output</h3>

<pre style='background: #2c3e50; color: #ecf0f1; padding: 20px; border-radius: 8px; overflow-x: auto; margin: 15px 0;'><code class='language-bash'># 1. Register a new user
curl -X POST http://localhost:5000/api/register \
  -H "Content-Type: application/json" \
  -d '{"username": "alice", "email": "alice@example.com", "password": "secret123"}'

# Response: {"message": "User created successfully", "user_id": 1}

# 2. Login to get JWT token
curl -X POST http://localhost:5000/api/login \
  -H "Content-Type: application/json" \
  -d '{"email": "alice@example.com", "password": "secret123"}'

# Response: {"token": "eyJ0eXAiOiJKV1QiLCJhbGc..."}

# 3. Create a task (requires token)
curl -X POST http://localhost:5000/api/tasks \
  -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGc..." \
  -H "Content-Type: application/json" \
  -d '{"title": "Learn Flask", "description": "Complete Flask tutorial", "priority": "high", "status": "in_progress"}'

# Response: {"id": 1, "title": "Learn Flask", "status": "in_progress", "created_at": "2026-01-05T10:30:00"}

# 4. Get all tasks with filtering
curl -X GET "http://localhost:5000/api/tasks?status=in_progress&page=1" \
  -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGc..."

# Response:
# {
#   "tasks": [
#     {"id": 1, "title": "Learn Flask", "status": "in_progress", "priority": "high"},
#     {"id": 2, "title": "Build API", "status": "in_progress", "priority": "medium"}
#   ],
#   "total": 2,
#   "page": 1,
#   "pages": 1
# }

# 5. Update a task
curl -X PUT http://localhost:5000/api/tasks/1 \
  -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGc..." \
  -H "Content-Type: application/json" \
  -d '{"status": "completed"}'

# Response: {"id": 1, "title": "Learn Flask", "status": "completed", "updated_at": "2026-01-05T14:20:00"}
</code></pre>

<h3 style='color: #ff9800; border-bottom: 2px solid #ff9800; padding-bottom: 8px; margin-top: 25px;'>üèÜ Bonus Challenges</h3>

<ul style='margin-left: 20px;'>
<li><strong>Level 2</strong>: Add task categories with many-to-many relationship (Task ‚Üî Category)</li>
<li><strong>Level 3</strong>: Implement task sharing: <code>POST /api/tasks/<id>/share</code> to share with other users</li>
<li><strong>Level 4</strong>: Add file attachments to tasks using secure file upload</li>
<li><strong>Level 5</strong>: Create real-time notifications using Flask-SocketIO when tasks are updated</li>
<li><strong>Level 6</strong>: Deploy to Heroku with PostgreSQL database and document API with Swagger/OpenAPI</li>
</ul>

<h3 style='color: #ff9800; border-bottom: 2px solid #ff9800; padding-bottom: 8px; margin-top: 25px;'>üìö Learning Goals</h3>

<ul style='margin-left: 20px;'>
<li>Master Flask routing and RESTful API design principles üéØ</li>
<li>Implement secure JWT-based authentication üîê</li>
<li>Build database models with SQLAlchemy relationships üóÉÔ∏è</li>
<li>Apply proper HTTP methods and status codes ‚ú®</li>
<li>Handle errors gracefully with try-except blocks üõ°Ô∏è</li>
<li>Create production-ready APIs used by real companies üöÄ</li>
</ul>

<p style='background: #3498db; color: #fff; padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 5px solid #2980b9;'>
<strong>üí° Pro Tip:</strong> This task management API pattern is used by Trello, Asana, and Todoist! JWT authentication is the industry standard for stateless API authentication, perfect for microservices and mobile apps. Master this, and you can build any RESTful API!
</p>

<p style='margin-top: 20px; font-size: 1.1em;'><strong>Share Your Solution! üí¨</strong></p>
<p>Completed the project? <strong>Post your code in the comments below!</strong> Show us your Flask API mastery! üöÄ‚ú®</p>

</div>
</details>

---

# <span style="color:#e67e22">Conclusion: Master Flask Web Development üéì</span>

Flask empowers you to build production-ready web applications and APIs with minimal boilerplate while maintaining maximum flexibility. From routing and templates to databases and REST APIs, Flask provides everything needed to create scalable, maintainable web services used by companies worldwide!

