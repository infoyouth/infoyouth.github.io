<!-- Learning Progress Tracker Integration -->
<!-- Load Learning Tracker Assets Globally -->
<link rel="stylesheet" href="{{ '/assets/css/learning-tracker.css' | relative_url }}">
<script defer src="{{ '/assets/js/learning-tracker.js' | relative_url }}">

<!-- Initialize with Jekyll data -->
{% if page.layout == 'post' or page.layout == 'category' %}
<script>
  // Pass Jekyll post/category data to the tracker
  window.learningTrackerData = {
    currentPage: {
      type: '{{ page.layout }}',
      title: '{{ page.title | escape }}',
      categories: [{% for cat in page.categories %}'{{ cat | escape }}'{% unless forloop.last %},{% endunless %}{% endfor %}],
      url: '{{ page.url | absolute_url }}'
    }{% if page.layout == 'category' %},
    categoryData: {
      name: '{{ page.category | default: page.title }}',
      posts: [
        {% assign category_posts = site.categories[page.category] | default: site.posts %}
        {% for post in category_posts %}
        {
          id: '{{ post.url | replace: '/', '-' | remove_first: '-' }}',
          title: '{{ post.title | escape }}',
          url: '{{ post.url | relative_url }}',
          date: '{{ post.date | date: "%Y-%m-%d" }}'
        }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ]
    }{% endif %}
  };
</script>
{% endif %}
